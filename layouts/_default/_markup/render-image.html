<style>
  /* When .dark is present on <html> or any parent */

  .image-found-dark {
    display: none;
  }
  .image-found-light {
    display: block;
  }
  .dark .image-found-dark {
    display: block;
  }
  .dark .image-found-light {
    display: none;
  }
  .dark .image-dark {
    display: block;
    filter: invert(1) hue-rotate(180deg);
  }
</style>

{{ $page := .Page }} {{ $resOwner := cond (gt (len $page.Resources) 0) $page
(index $page.Translations 0) }} {{ $src := $resOwner.Resources.GetMatch
.Destination }}{{- $alt := .Text -}} {{- $title := .Title -}} {{- $ext :=
path.Ext $src | lower -}} {{- $darkSrc := $src -}} {{- $darkPath := replaceRE
"(?i)(\\.[^./]+)$" "-dark$1" .Destination -}} {{- $darkRes :=
$resOwner.Resources.GetMatch $darkPath -}} {{- if $darkRes -}}

<img
  src="{{ $src | safeURL }}"
  class="image-found-light"
  alt="{{ $alt }}"
  {{
  with
  $title
  }}title="{{ . }}"
  {{
  end
  }}
/>

<img
  src="{{ $darkSrc | safeURL }}"
  class="image-found-dark"
  alt="{{ $alt }}"
  {{
  with
  $title
  }}title="{{ . }}"
  {{
  end
  }}
/>
{{- else -}}

<img
  src="{{ $darkSrc | safeURL }}"
  class="image-dark"
  alt="{{ $alt }}"
  {{
  with
  $title
  }}title="{{ . }}"
  {{
  end
  }}
/>
{{ end }}
